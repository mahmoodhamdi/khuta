# Milestone 4.2: Widget Tests for Screens

> **Phase:** 4 - Testing & Documentation
> **Priority:** MEDIUM
> **Status:** Done
> **Last Updated:** 2025-12-27

---

## Missing Widget Tests

- AssessmentScreen
- ResultsScreen
- HomeScreen
- AddChildScreen
- SettingsScreen

---

## Create Widget Tests

### AssessmentScreen Test

Create `test/widgets/assessment_screen_test.dart`:

```dart
import 'package:flutter/material.dart';
import 'package:flutter_test/flutter_test.dart';
import 'package:flutter_bloc/flutter_bloc.dart';
import 'package:easy_localization/easy_localization.dart';
import 'package:khuta/screens/child/assessment/assessment_screen.dart';
import 'package:khuta/models/child.dart';
import 'package:khuta/models/question.dart';

void main() {
  group('AssessmentScreen', () {
    late Child mockChild;
    late List<Question> mockQuestions;

    setUp(() {
      mockChild = Child(name: 'Test Child', age: 8, gender: 'male');
      mockQuestions = [
        Question(questionText: 'Test question 1?', questionType: 'parent'),
        Question(questionText: 'Test question 2?', questionType: 'parent'),
      ];
    });

    testWidgets('renders question text', (WidgetTester tester) async {
      await tester.pumpWidget(
        MaterialApp(
          home: EasyLocalization(
            supportedLocales: const [Locale('en')],
            path: 'test/helpers/mock_translations',
            fallbackLocale: const Locale('en'),
            child: AssessmentScreen(child: mockChild, questions: mockQuestions),
          ),
        ),
      );
      await tester.pumpAndSettle();

      expect(find.text('Test question 1?'), findsOneWidget);
    });

    testWidgets('enables next button when answer selected', (WidgetTester tester) async {
      // Build widget
      // Select an answer
      // Verify next button is enabled
    });

    testWidgets('navigates to next question on next tap', (WidgetTester tester) async {
      // Build widget
      // Select answer
      // Tap next
      // Verify question 2 is shown
    });
  });
}
```

### HomeScreen Test

Create `test/widgets/home_screen_test.dart`:

```dart
testWidgets('shows empty state when no children', (WidgetTester tester) async {
  // Mock repository to return empty list
  // Build HomeScreen
  // Verify empty state message is shown
});

testWidgets('shows child cards when children exist', (WidgetTester tester) async {
  // Mock repository to return children
  // Build HomeScreen
  // Verify child cards are rendered
});
```

---

## Test Helper Setup

Update `test/helpers/test_helpers.dart` with widget test utilities.

---

## Progress Tracking

- [ ] Create AssessmentScreen tests
- [ ] Create ResultsScreen tests
- [ ] Create HomeScreen tests
- [ ] Create AddChildScreen tests
- [ ] Create SettingsScreen tests
- [ ] All tests pass
- [ ] Update checklist
