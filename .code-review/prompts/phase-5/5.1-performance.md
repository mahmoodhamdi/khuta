# Milestone 5.1: Performance Optimization

> **Phase:** 5 - Performance & Polish
> **Priority:** LOW
> **Status:** Done
> **Last Updated:** 2025-12-27

---

## Performance Issues

1. No pagination for children list
2. Color calculations repeated on every build
3. Large prompt printed to debug console

---

## Required Changes

### 1. Add pagination to children query

```dart
Future<List<Child>> getChildren({int limit = 20, DocumentSnapshot? startAfter}) async {
  var query = _childrenCollection
      .where('isDeleted', isNotEqualTo: true)
      .orderBy('createdAt', descending: false)
      .limit(limit);

  if (startAfter != null) {
    query = query.startAfterDocument(startAfter);
  }

  final snapshot = await query.get();
  return snapshot.docs.map((doc) => Child.fromFirestore(doc)).toList();
}
```

### 2. Cache computed colors

```dart
class ScoreColorCache {
  static final Map<String, Color> _cache = {};

  static Color getColor(int score, bool isDark) {
    final key = '$score-$isDark';
    return _cache.putIfAbsent(key, () => _computeColor(score, isDark));
  }
}
```

### 3. Remove debug prints from production

```dart
if (kDebugMode) {
  debugPrint('Prompt: ${prompt[0].parts[0]}');
}
```

---

## Progress Tracking

- [x] Add pagination
- [x] Cache color calculations
- [x] Remove debug prints
- [x] Profile app performance
- [x] Update checklist
